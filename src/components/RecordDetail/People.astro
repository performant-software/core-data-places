---
import Container from "@components/Container.astro";
import Layout from "@layouts/Layout.astro";
import config from "@config";
import { getTranslations } from "@i18n/server";

interface Props {
    data: any;
}

const lang = Astro.currentLocale;
const { t } = await getTranslations(Astro.currentLocale);
const { data } = Astro.props;
---

<Layout footer t={t} title={data.name}>
    <Container className="flex flex-col py-12 gap-12 w-full">
        <h1 class="font-bold text-2xl">{data.name}</h1>
        {data.description ? <p>{data.description}</p> : null}
        <div class="flex flex-col gap-6">
        {
            data?.relatedRecords &&
            Object.keys(data.relatedRecords).map((key) =>
                data.relatedRecords[key]?.length ? (
                <div class="flex flex-col gap-4">
                    {/* TODO: this string should come from i18n */}
                    <h2 class="capitalize text-xl font-semibold">{`Related ${key}`}</h2>
                    <ul>
                    {data.relatedRecords[key].map((record) =>
                        config.detail_pages.includes(key) ? (
                        <a href={`/${lang}/${key}/${record.uuid}`}>
                            <li>{record.name}</li>
                        </a>
                        ) : (
                        <li>{record.name}</li>
                        )
                    )}
                    </ul>
                </div>
                ) : null
            )
        }
        </div>
    </Container>
</Layout>